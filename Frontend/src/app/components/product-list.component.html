<div class="container">
  <h2>Product Master</h2>

  <!-- CREATE / EDIT PRODUCT FORM -->
  <div class="card">
    <h3>{{ isEditing ? 'Edit Product' : 'Add Product' }}</h3>

    <form (ngSubmit)="saveProduct()" #productForm="ngForm">
      <div class="form-row">
        <label>Product Name</label>
        <input
          type="text"
          name="name"
          [(ngModel)]="newProduct.name"
          required
        />
      </div>

      <div class="form-row">
        <label>Category</label>
        <select
          name="category_id"
          [(ngModel)]="newProduct.category_id"
          required
        >
          <option value="0">Select Category</option>
          <option *ngFor="let c of categories" [value]="c.id">
            {{ c.name }}
          </option>
        </select>
      </div>

      <div class="form-row">
        <label>Price</label>
        <input
          type="number"
          name="price"
          [(ngModel)]="newProduct.price"
          required
        />
      </div>

      <div class="form-row">
        <label>Description</label>
        <textarea
          name="description"
          [(ngModel)]="newProduct.description"
        ></textarea>
      </div>

      <div class="button-group">
        <button type="submit" [disabled]="productForm.invalid">
          {{ isEditing ? 'Update Product' : 'Save Product' }}
        </button>

        <button
          type="button"
          *ngIf="isEditing"
          (click)="resetForm()"
        >
          Cancel
        </button>
      </div>
    </form>
  </div>

  <!-- PRODUCT LIST -->
  <table class="product-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Product Name</th>
        <th>Category</th>
        <th>Price (â‚¹)</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let product of products">
        <td>{{ product.id }}</td>
        <td>{{ product.name }}</td>
        <td>{{ product.categoryName }}</td>
        <td>{{ product.price }}</td>
        <td>
          <button class="btn-edit" (click)="editProduct(product)">Edit</button>
          <button class="btn-delete" (click)="deleteProduct(product.id)">Delete</button>
        </td>
      </tr>

      <tr *ngIf="products.length === 0">
        <td colspan="5">No products found</td>
      </tr>
    </tbody>
  </table>

  <!-- PAGINATION -->
  <div class="pagination" *ngIf="totalPages > 1">
    <button (click)="previousPage()" [disabled]="currentPage === 1">
      Prev
    </button>

    <span>Page {{ currentPage }} of {{ totalPages }}</span>

    <button
      (click)="nextPage()"
      [disabled]="currentPage === totalPages"
    >
      Next
    </button>
  </div>
</div>
